<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chinese Character Builder</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .game-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }
        
        .target-area {
            background: #f0f4ff;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            min-height: 120px;
        }
        
        .question {
            font-size: 18px;
            color: #555;
            margin-bottom: 15px;
        }
        
        .meaning-box {
            display: inline-block;
            background: white;
            border: 3px solid #667eea;
            border-radius: 10px;
            padding: 15px 30px;
            font-size: 20px;
            color: #333;
            margin: 10px;
        }
        
        .builder-area {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .slot {
            width: 80px;
            height: 80px;
            border: 3px dashed #ccc;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            background: #fafafa;
            transition: all 0.3s;
        }
        
        .slot.filled {
            border-style: solid;
            border-color: #667eea;
            background: #e8eeff;
        }
        
        .plus {
            font-size: 30px;
            color: #999;
            font-weight: bold;
        }
        
        .equals {
            font-size: 30px;
            color: #666;
            font-weight: bold;
        }
        
        .result {
            width: 80px;
            height: 80px;
            border: 3px solid #764ba2;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            background: #f3e8ff;
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        .result.show {
            opacity: 1;
        }
        
        .choices {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .choice-btn {
            padding: 15px 25px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            font-size: 36px;
            transition: all 0.2s;
            position: relative;
        }
        
        .choice-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-color: #667eea;
        }
        
        .choice-btn.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .choice-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .choice-btn .pinyin {
            display: block;
            font-size: 12px;
            margin-top: 5px;
            color: #666;
        }
        
        .choice-btn.selected .pinyin {
            color: rgba(255,255,255,0.8);
        }
        
        .label {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 3px 10px;
            border-radius: 5px;
            font-size: 11px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .choice-btn:hover:not(:disabled) .label {
            opacity: 1;
        }
        
        .feedback {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: bold;
            display: none;
        }
        
        .feedback.correct {
            background: #d4edda;
            color: #155724;
            display: block;
        }
        
        .feedback.wrong {
            background: #f8d7da;
            color: #721c24;
            display: block;
            border-left: 4px solid #dc3545;
        }
        
        .feedback.hint {
            background: #fff3cd;
            color: #856404;
            border-left: 4px solid #ffc107;
        }
        
        .controls {
            text-align: center;
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn:hover:not(:disabled) {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102,126,234,0.4);
        }
        
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .btn.secondary {
            background: #6c757d;
        }
        
        .btn.secondary:hover:not(:disabled) {
            background: #5a6268;
        }
        
        .btn.warning {
            background: #ffc107;
            color: #212529;
        }
        
        .btn.warning:hover:not(:disabled) {
            background: #e0a800;
        }
        
        .progress {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .instruction-box {
            background: #e7f3ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            color: #004085;
            font-size: 14px;
        }
        
        .hint-text {
            font-size: 13px;
            color: #666;
            margin-top: 10px;
            font-style: italic;
        }
    </style>
<base target="_blank">
</head>
<body>
    <div class="game-container">
        <h1>üß© Character Builder</h1>
        <div class="subtitle">Learn how Chinese characters combine!</div>
        
        <div class="progress">Question <span id="current">1</span> of 3</div>
        
        <div class="instruction-box" id="instruction">
            <strong>Rule:</strong> Left part = Meaning ‚Ä¢ Right part = Sound<br>
            Build the character by choosing the correct parts!
        </div>

        <div class="target-area">
            <div class="question">Build the character for:</div>
            <div class="meaning-box" id="targetMeaning">
                <span style="font-size: 40px;">üë©</span><br>
                <strong>Mother</strong><br>
                <span style="font-size: 14px; color: #666;">sounds like "ma"</span>
            </div>
            <div class="hint-text" id="hintText">Hint: A mother is a female person</div>
        </div>

        <div class="builder-area">
            <div class="slot" id="leftSlot">?</div>
            <div class="plus">+</div>
            <div class="slot" id="rightSlot">?</div>
            <div class="equals">=</div>
            <div class="result" id="finalChar">Â¶à</div>
        </div>

        <div class="question" id="stepTitle">Step 1: Choose the left part (meaning):</div>
        
        <div class="choices" id="choicesContainer">
            <!-- Buttons will be generated by JS -->
        </div>

        <div class="feedback" id="feedback"></div>

        <div class="controls">
            <button class="btn" id="checkBtn" onclick="checkAnswer()" disabled>Check Answer</button>
            <button class="btn secondary" id="retryBtn" onclick="retryStep()" style="display:none;">‚Üê Change Selection</button>
            <button class="btn warning" id="restartBtn" onclick="restartQuestion()" style="display:none;">‚Ü∫ Start Over</button>
            <button class="btn" id="nextBtn" onclick="nextQuestion()" style="display:none;">Next ‚Üí</button>
        </div>
    </div>

    <script>
        const questions = [
            {
                meaning: "Mother",
                emoji: "üë©",
                soundHint: "ma",
                hint: "A mother is a female person",
                correctLeft: "Â•≥",
                correctRight: "È©¨",
                character: "Â¶à",
                pinyin: "mƒÅ",
                wrongLeftHint: "Think: Is a mother a woman or an insect?",
                wrongRightHint: "Listen: Does 'mother' sound like 'ma' (horse) or 'wen' (culture)?"
            },
            {
                meaning: "Ant",
                emoji: "üêú",
                soundHint: "ma", 
                hint: "An ant is an insect",
                correctLeft: "Ëô´",
                correctRight: "È©¨",
                character: "ËöÇ",
                pinyin: "m«é",
                wrongLeftHint: "Think: Is an ant a woman or an insect?",
                wrongRightHint: "Listen: Does 'ant' sound like 'ma' (horse) or 'wen' (culture)?"
            },
            {
                meaning: "Mosquito",
                emoji: "ü¶ü",
                soundHint: "wen",
                hint: "A mosquito is an insect",
                correctLeft: "Ëô´",
                correctRight: "Êñá",
                character: "Ëöä",
                pinyin: "w√©n",
                wrongLeftHint: "Think: Is a mosquito a woman or an insect?",
                wrongRightHint: "Listen: Does 'mosquito' sound like 'ma' (horse) or 'wen' (culture)?"
            }
        ];

        let currentQ = 0;
        let step = 1;
        let selectedLeft = null;
        let selectedRight = null;
        let errorStep = null; // Track which step had error

        function loadQuestion() {
            const q = questions[currentQ];
            document.getElementById('current').textContent = currentQ + 1;
            document.getElementById('targetMeaning').innerHTML = `
                <span style="font-size: 40px;">${q.emoji}</span><br>
                <strong>${q.meaning}</strong><br>
                <span style="font-size: 14px; color: #666;">pronunciation hint: "${q.soundHint}"</span>
            `;
            document.getElementById('hintText').textContent = "Hint: " + q.hint;
            document.getElementById('finalChar').textContent = q.character;
            document.getElementById('finalChar').classList.remove('show');
            
            resetSlots();
            resetButtons();
            step = 1;
            errorStep = null;
            updateStep();
        }

        function resetSlots() {
            document.getElementById('leftSlot').textContent = '?';
            document.getElementById('leftSlot').classList.remove('filled');
            document.getElementById('rightSlot').textContent = '?';
            document.getElementById('rightSlot').classList.remove('filled');
            selectedLeft = null;
            selectedRight = null;
        }

        function resetButtons() {
            document.getElementById('checkBtn').style.display = 'inline-block';
            document.getElementById('checkBtn').disabled = true;
            document.getElementById('retryBtn').style.display = 'none';
            document.getElementById('restartBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('feedback').style.display = 'none';
        }

        function updateStep() {
            const q = questions[currentQ];
            const title = document.getElementById('stepTitle');
            const container = document.getElementById('choicesContainer');
            
            if (step === 1) {
                title.innerHTML = 'Step 1: Choose the <strong>meaning part</strong> (left side):<br><small>Is it related to women or insects?</small>';
                container.innerHTML = `
                    <button class="choice-btn" onclick="selectLeft('Â•≥', this)" data-radical="Â•≥">
                        Â•≥
                        <span class="label">Woman/Female</span>
                        <span class="pinyin">woman</span>
                    </button>
                    <button class="choice-btn" onclick="selectLeft('Ëô´', this)" data-radical="Ëô´">
                        Ëô´
                        <span class="label">Insect/Bug</span>
                        <span class="pinyin">insect</span>
                    </button>
                `;
            } else {
                title.innerHTML = `Step 2: Choose the <strong>sound part</strong> (right side):<br><small>"${q.meaning}" sounds like...</small>`;
                container.innerHTML = `
                    <button class="choice-btn" onclick="selectRight('È©¨', this)" data-parts="È©¨">
                        È©¨
                        <span class="label">Horse</span>
                        <span class="pinyin">m«é (sounds "ma")</span>
                    </button>
                    <button class="choice-btn" onclick="selectRight('Êñá', this)" data-parts="Êñá">
                        Êñá
                        <span class="label">Culture</span>
                        <span class="pinyin">w√©n (sounds "wen")</span>
                    </button>
                `;
                
                // If we have a left selection, show it as selected but disable it
                if (selectedLeft) {
                    const leftBtn = document.createElement('div');
                    leftBtn.style.cssText = 'width:100%; text-align:center; margin-bottom:10px; color:#666; font-size:14px;';
                    leftBtn.innerHTML = `Selected: <strong>${selectedLeft}</strong> (${selectedLeft === 'Â•≥' ? 'woman' : 'insect'}) ‚Üê`;
                    container.insertBefore(leftBtn, container.firstChild);
                }
            }
        }

        function selectLeft(radical, btn) {
            selectedLeft = radical;
            document.getElementById('leftSlot').textContent = radical;
            document.getElementById('leftSlot').classList.add('filled');
            
            document.querySelectorAll('.choice-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            
            if (step === 1) {
                setTimeout(() => {
                    step = 2;
                    updateStep();
                }, 600);
            } else {
                checkCompletion();
            }
        }

        function selectRight(part, btn) {
            selectedRight = part;
            document.getElementById('rightSlot').textContent = part;
            document.getElementById('rightSlot').classList.add('filled');
            
            document.querySelectorAll('.choice-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            
            checkCompletion();
        }

        function checkCompletion() {
            if (selectedLeft && selectedRight) {
                document.getElementById('checkBtn').disabled = false;
            }
        }

        function checkAnswer() {
            const q = questions[currentQ];
            const leftCorrect = selectedLeft === q.correctLeft;
            const rightCorrect = selectedRight === q.correctRight;
            const feedback = document.getElementById('feedback');
            
            if (leftCorrect && rightCorrect) {
                // Correct answer
                feedback.className = 'feedback correct';
                feedback.innerHTML = `
                    ‚úÖ <strong>Perfect!</strong><br>
                    <small>You built it correctly! ${selectedLeft} (meaning) + ${selectedRight} (sound) = ${q.character}</small>
                `;
                document.getElementById('finalChar').classList.add('show');
                document.getElementById('checkBtn').style.display = 'none';
                document.getElementById('nextBtn').style.display = 'inline-block';
                document.getElementById('stepTitle').innerHTML = '<strong style="color:#155724;">Character Complete!</strong>';
                
                // Disable all choices
                document.querySelectorAll('.choice-btn').forEach(b => b.disabled = true);
            } else {
                // Wrong answer - Don't show the answer!
                errorStep = step;
                feedback.className = 'feedback wrong';
                
                let hintMsg = '';
                if (!leftCorrect) {
                    hintMsg = q.wrongLeftHint;
                } else if (!rightCorrect) {
                    hintMsg = q.wrongRightHint;
                }
                
                feedback.innerHTML = `
                    ‚ùå <strong>Not quite right.</strong><br>
                    <small>${hintMsg}</small>
                `;
                
                // Show retry options
                document.getElementById('checkBtn').style.display = 'none';
                document.getElementById('retryBtn').style.display = 'inline-block';
                document.getElementById('restartBtn').style.display = 'inline-block';
                
                // Disable current choices to force user to use retry buttons
                document.querySelectorAll('.choice-btn').forEach(b => b.disabled = true);
            }
            feedback.style.display = 'block';
        }

        function retryStep() {
            // Go back to the step where error occurred (or stay on current if step 2)
            const feedback = document.getElementById('feedback');
            feedback.style.display = 'none';
            
            if (step === 2 && selectedRight) {
                // Clear only step 2 selection
                selectedRight = null;
                document.getElementById('rightSlot').textContent = '?';
                document.getElementById('rightSlot').classList.remove('filled');
                document.getElementById('checkBtn').disabled = true;
                
                // Show selection buttons again
                document.getElementById('retryBtn').style.display = 'none';
                document.getElementById('restartBtn').style.display = 'none';
                document.getElementById('checkBtn').style.display = 'inline-block';
                updateStep();
            } else {
                // If on step 1 or no selection yet, full restart
                restartQuestion();
            }
        }

        function restartQuestion() {
            // Complete reset of current question
            document.getElementById('feedback').style.display = 'none';
            document.getElementById('finalChar').classList.remove('show');
            
            resetSlots();
            step = 1;
            errorStep = null;
            
            document.getElementById('retryBtn').style.display = 'none';
            document.getElementById('restartBtn').style.display = 'none';
            document.getElementById('checkBtn').style.display = 'inline-block';
            document.getElementById('checkBtn').disabled = true;
            
            updateStep();
        }

        function nextQuestion() {
            currentQ++;
            if (currentQ >= questions.length) {
                showCompletion();
            } else {
                loadQuestion();
            }
        }

        function showCompletion() {
            document.querySelector('.target-area').innerHTML = `
                <div style="font-size: 60px; margin: 20px;">üéâ</div>
                <h2>Lesson Complete!</h2>
                <p>You've mastered the basics of ÂΩ¢Â£∞Â≠ó (pictophonetic characters)!</p>
                <div style="background:#f8f9fa; padding:15px; border-radius:10px; margin:20px 0; text-align:left;">
                    <strong>Summary:</strong><br>
                    ‚Ä¢ Â¶à (mƒÅ) = Â•≥ (woman) + È©¨ (sound ma) = Mother<br>
                    ‚Ä¢ ËöÇ (m«é) = Ëô´ (insect) + È©¨ (sound ma) = Ant<br>
                    ‚Ä¢ Ëöä (w√©n) = Ëô´ (insect) + Êñá (sound wen) = Mosquito
                </div>
                <p><strong>Key Rule:</strong> Left side = Meaning, Right side = Sound!</p>
            `;
            document.querySelector('.builder-area').style.display = 'none';
            document.querySelector('.choices').style.display = 'none';
            document.getElementById('stepTitle').style.display = 'none';
            document.getElementById('feedback').style.display = 'none';
            document.getElementById('checkBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('retryBtn').style.display = 'none';
            document.getElementById('restartBtn').style.display = 'none';
            document.getElementById('instruction').innerHTML = '<strong>Congratulations!</strong> You understand how Chinese characters combine meaning and sound!';
        }

        // Start game
        loadQuestion();
    </script>
</body>
</html>